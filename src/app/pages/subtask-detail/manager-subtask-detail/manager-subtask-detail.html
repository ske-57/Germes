<div class="manager-dashboard">
    <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <div class="left-panel">
        <div class="projects-section">
            <div class="projects-list">
                <button class="project-button" (click)="backToSubtasks()">‚Üê –ù–∞–∑–∞–¥ –∫ –∑–∞–¥–∞—á–∞–º –≤–∏–¥–∞ —Ä–∞–±–æ—Ç</button>
                <button class="project-button active">–ü—Ä–æ–µ–∫—Ç: {{ currentProject.name }}</button>
                <button class="project-button active small">–≠—Ç–∞–ø: {{ currentStage.title }}</button>
                <button class="project-button active small">–í–∏–¥ —Ä–∞–±–æ—Ç: {{ currentTask?.task_name || '‚Äî' }}</button>
                <button class="project-button active small">–ó–∞–¥–∞—á–∞: {{ currentSubtask?.subtask_name || '‚Äî' }}</button>
            </div>
        </div>

        <div class="bottom-section">
            <button class="action-button" (click)="toTime()">–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã</button>
            <button class="action-button" (click)="toTaskEmployees()">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∑–∞–¥–∞—á–∏</button>
        </div>
    </div>

    <!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å -->
    <div class="divider"></div>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="main-content">
        <!-- –ü–æ–∏—Å–∫ (–∑–∞–≥–ª—É—à–∫–∞) -->
        <div class="search-bar">
            <input class="search-input" type="text"
                [placeholder]="'–ü–æ–∏—Å–∫ –ø–æ –∑–∞–¥–∞—á–µ ¬´' + (currentSubtask?.subtask_name || '‚Äî') + '¬ª'"
                [formControl]="searchControl" />
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–µ—Ç–∞–ª–µ–π -->
        <div class="details-card">
            <h2>–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏</h2>

            <div class="grid">
                <div class="col">
                    <div class="field">
                        <div class="label">–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                        <div class="value">
                            {{ currentSubtask?.subtask_description || '‚Äî' }}
                        </div>
                    </div>

                    <div class="field">
                        <div class="label">–ö—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç</div>
                        <div class="value">
                            <span class="chip" *ngFor="let a of details.assignees">{{ a }}</span>
                        </div>
                    </div>

                    <div class="field">
                        <div class="label">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                        <div class="value">{{ details.deadline || '‚Äî' }}</div>
                    </div>

                    <!-- <div class="field"> -->
                    <!-- <div class="label">–í—Ä–µ–º—è –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º</div> -->
                    <!-- <div class="value"> -->
                    <!-- <span class="badge" *ngFor="let t of (currentSubtask?.time_intervals || [])">
                                {{ t.start_time | date:'short' }}
                                <ng-container *ngIf="t.end_time">‚Äî {{ t.end_time | date:'short' }}</ng-container>
                                ({{ t.status }})
                            </span> -->
                    <!-- <span *ngIf="!(currentSubtask?.time_intervals?.length)">‚Äî</span> -->
                    <!-- </div> -->
                    <!-- </div> -->
                    <!-- </div> -->

                    <div class="col">
                        <div class="field">
                            <div class="label">–ü–ª–∞–Ω–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</div>
                            <div class="value strong">{{ details.plannedQty ?? '‚Äî' }}</div>
                        </div>

                        <div class="field">
                            <div class="label">–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</div>
                            <div class="value strong">{{ details.actualQty ?? '‚Äî' }}</div>
                        </div>

                        <div class="field">
                            <div class="label">–ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                            <div class="value">
                                <div class="progress">
                                    <div class="bar" [style.width.%]="progressPercent || 0"></div>
                                </div>
                                <span class="progress-text">{{ progressPercent != null ? (progressPercent + '%') : '‚Äî'
                                    }}</span>
                            </div>
                        </div>

                        <div class="field">
                            <div class="label">–†–∞–±–æ—Ç–∞ —Ç–µ—Ö–Ω–∏–∫–∏</div>
                            <div class="value">
                                <span class="badge">–ß–∞—Å—ã: {{ details.machine?.hours ?? '‚Äî' }}</span>
                                <span class="badge">–ï–¥–∏–Ω–∏—Ü—ã: {{ details.machine?.units ?? '‚Äî' }}</span>
                            </div>
                        </div>

                        <!-- <div class="field">
                            <div class="label">–û—Ç—á—ë—Ç—ã (–≤–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏)</div>
                            <div class="value links">
                                <a *ngFor="let r of (details.reportLinks || [])" href="{{ r.href }}" target="_blank"
                                    rel="noopener">
                                    üìé {{ r.title }}
                                </a>
                                <span *ngIf="!(details.reportLinks?.length)">‚Äî</span>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>

        </div>
    </div>